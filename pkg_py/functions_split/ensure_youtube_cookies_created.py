"""
YouTube ì¿ í‚¤ íŒŒì¼ ìƒì„± ë° ê´€ë¦¬ í•¨ìˆ˜
"""

from pkg_py.functions_split.ensure_printed import ensure_printed
from pkg_py.system_object.files import F_YOUTUBE_COOKIES_TXT
import os
import subprocess

def ensure_youtube_cookies_created():
    """
    YouTube ì¿ í‚¤ íŒŒì¼ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
    
    Returns:
        bool: ì¿ í‚¤ íŒŒì¼ ìƒì„± ì„±ê³µ ì—¬ë¶€
    """
    try:
        # ì¿ í‚¤ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
        if os.path.exists(F_YOUTUBE_COOKIES_TXT):
            ensure_printed(f"âœ… YouTube ì¿ í‚¤ íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤: {F_YOUTUBE_COOKIES_TXT}", print_color="green")
            return True
        
        # ì¿ í‚¤ íŒŒì¼ ìƒì„± ì•ˆë‚´
        ensure_printed("ğŸª YouTube ì¿ í‚¤ íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.", print_color="yellow")
        ensure_printed("ğŸ“ ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë”°ë¼í•˜ì„¸ìš”:", print_color="cyan")
        ensure_printed("1. ë¸Œë¼ìš°ì €ì—ì„œ YouTubeì— ë¡œê·¸ì¸", print_color="cyan")
        ensure_printed("2. ê°œë°œì ë„êµ¬ ì—´ê¸° (F12)", print_color="cyan")
        ensure_printed("3. Application/Storage íƒ­ì—ì„œ Cookies í™•ì¸", print_color="cyan")
        ensure_printed("4. ì¿ í‚¤ë¥¼ Netscape í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°", print_color="cyan")
        ensure_printed(f"5. íŒŒì¼ì„ ë‹¤ìŒ ê²½ë¡œì— ì €ì¥: {F_YOUTUBE_COOKIES_TXT}", print_color="cyan")
        
        # ì¿ í‚¤ íŒŒì¼ í…œí”Œë¦¿ ìƒì„±
        cookie_template = """# Netscape HTTP Cookie File
# This file is generated by yt-dlp.  Do not edit.

.youtube.com	TRUE	/	TRUE	1735689600	VISITOR_INFO1_LIVE
.youtube.com	TRUE	/	TRUE	1735689600	LOGIN_INFO
.youtube.com	TRUE	/	TRUE	1735689600	SID
.youtube.com	TRUE	/	TRUE	1735689600	HSID
.youtube.com	TRUE	/	TRUE	1735689600	SSID
.youtube.com	TRUE	/	TRUE	1735689600	APISID
.youtube.com	TRUE	/	TRUE	1735689600	SAPISID
.youtube.com	TRUE	/	TRUE	1735689600	__Secure-1PSID
.youtube.com	TRUE	/	TRUE	1735689600	__Secure-3PSID
.youtube.com	TRUE	/	TRUE	1735689600	__Secure-1PAPISID
.youtube.com	TRUE	/	TRUE	1735689600	__Secure-3PAPISID
"""
        
        # ì¿ í‚¤ íŒŒì¼ ìƒì„±
        with open(F_YOUTUBE_COOKIES_TXT, 'w', encoding='utf-8') as f:
            f.write(cookie_template)
        
        ensure_printed(f"ğŸ“„ ì¿ í‚¤ íŒŒì¼ í…œí”Œë¦¿ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤: {F_YOUTUBE_COOKIES_TXT}", print_color="green")
        ensure_printed("âš ï¸ ì‹¤ì œ ì¿ í‚¤ ê°’ìœ¼ë¡œ êµì²´í•´ì•¼ í•©ë‹ˆë‹¤.", print_color="yellow")
        
        return True
        
    except Exception as e:
        ensure_printed(f"âŒ ì¿ í‚¤ íŒŒì¼ ìƒì„± ì‹¤íŒ¨: {e}", print_color="red")
        return False

def get_youtube_cookies_help():
    """
    YouTube ì¿ í‚¤ ìƒì„± ë„ì›€ë§ì„ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜
    """
    help_text = """
ğŸª YouTube ì¿ í‚¤ ìƒì„± ë°©ë²•:

1. ë¸Œë¼ìš°ì €ì—ì„œ YouTubeì— ë¡œê·¸ì¸
2. ê°œë°œì ë„êµ¬ ì—´ê¸° (F12)
3. Application/Storage íƒ­ì—ì„œ Cookies í™•ì¸
4. ì¿ í‚¤ë¥¼ Netscape í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°
5. íŒŒì¼ì„ ë‹¤ìŒ ê²½ë¡œì— ì €ì¥: {cookie_file}

ğŸ’¡ ì¿ í‚¤ ë¸Œë¼ìš°ì € í™•ì¥ í”„ë¡œê·¸ë¨ ì‚¬ìš©:
- Chrome: "Get cookies.txt" í™•ì¥ í”„ë¡œê·¸ë¨
- Firefox: "cookies.txt" í™•ì¥ í”„ë¡œê·¸ë¨

ğŸ”— ìœ ìš©í•œ ë§í¬:
- https://github.com/yt-dlp/yt-dlp/wiki/FAQ#how-do-i-pass-cookies-to-yt-dlp
- https://github.com/yt-dlp/yt-dlp/wiki/Extractors#exporting-youtube-cookies
""".format(cookie_file=F_YOUTUBE_COOKIES_TXT)
    
    ensure_printed(help_text, print_color="cyan")

if __name__ == "__main__":
    ensure_youtube_cookies_created()
    get_youtube_cookies_help() 